if(!WELLNESS)var WELLNESS={};WELLNESS.CLIENT||(WELLNESS.CLIENT={}),WELLNESS.CLIENT.Main=function(){this.url="login",this.addEvents(this.url),this.playeruser=null},WELLNESS.CLIENT.Main.prototype.addEvents=function(url,data){this.url=url;var that=this;switch(url){case"login":that.addLoginEvents();break;case"home":that.addHomeEvents();break;case"dashboard":that.addDashEvents(data);break;case"playerform":that.addFormEvents();break;case"editquestions":that.data=data,that.addEditEvents();break;case"generalreport":that.addReportEvents()}},WELLNESS.CLIENT.Main.prototype.addLoginEvents=function(){$("#login").click(function(){var user=$("#user").val(),pass=$("#pass").val(),remember=$("#remember-me input").is(":checked");$.ajax({url:"/",type:"POST",data:{user:user,pass:pass,remember:remember},success:function(result){if("perfect"===result.type){var protocol=""!=window.location.protocol?window.location.protocol+"//":"",host=""!=window.location.host?window.location.host+"/":"";window.location.href=protocol+host+result.redirect}else $("#login-container").addClass("incorrect")}})})},WELLNESS.CLIENT.Main.prototype.addHomeEvents=function(){$("#traineedash").on("click",function(){$("#traineepop").find(".popUp").removeClass("incorrect"),$("#traineepop").show()}),$("#traineepop").on("click",function(e){var $box=$("#traineepop .popUp");$box.is(e.target)||0!==$box.has(e.target).length||$(this).hide()}),$("#traineelogin").click(function(){var pass=$("#traineepass").val();$.ajax({url:"/home",type:"POST",data:{pass:pass},success:function(result){if("trainee"===result.type){var protocol=""!=window.location.protocol?window.location.protocol+"//":"",host=""!=window.location.host?window.location.host+"/":"";window.location.href=protocol+host+result.redirect}else $("#traineepop").find(".popUp").addClass("invalid-password"===result.type?"incorrect":"incorrect")}})}),$("#playerdash").click(function(){var protocol=""!=window.location.protocol?window.location.protocol+"//":"",host=""!=window.location.host?window.location.host+"/":"";window.location.href=protocol+host+"dashboard"})},WELLNESS.CLIENT.Main.prototype.addDashEvents=function(isTrainee){$("#backtohome").on("click",function(){var protocol=""!=window.location.protocol?window.location.protocol+"//":"",host=""!=window.location.host?window.location.host+"/":"";window.location.href=protocol+host+"home"}),isTrainee?(setInterval(function(){$.ajax({url:"/dashboard",type:"GET",data:{refresh:!0},success:function(player_list){for(var k=0;k<player_list.length;k++){var current_player=player_list[k];current_player.formCompleated&&$(".playerImage."+current_player.surname.toLowerCase()).addClass("completedForm")}}})},15e3),$("#changequestions").on("click",function(){var protocol=""!=window.location.protocol?window.location.protocol+"//":"",host=""!=window.location.host?window.location.host+"/":"";window.location.href=protocol+host+"editquestions"}),$("#generalreport").on("click",function(){var protocol=""!=window.location.protocol?window.location.protocol+"//":"",host=""!=window.location.host?window.location.host+"/":"";window.location.href=protocol+host+"generalreport"})):($(".player_login").on("click",function(){$("#playerpop").find("#playerday").val(null),$("#playerpop").find("#playermonth").val(null),$("#playerpop").find("#playeryear").val(null),$("#playerpop").find(".popUp").removeClass("incorrect");var user=$(this).attr("data-user");$("#playerpop").attr("data-user",user),$("#playerpop").find(".popUpPlayerCircle").empty().append('<div class="playerImage "'+user+'"></div>'),$("#playerpop").find(".playerInfo").empty().append('<span class="playerNo">'+$(this).find(".playerNo").html()+"</span>"+user),$("#playerpop").show()}),$("#playerpop").on("click",function(e){var $box=$("#playerpop .popUp.dob");$box.is(e.target)||0!==$box.has(e.target).length||$(this).hide()}),$("#playerlogin").click(function(){var user=$("#playerpop").attr("data-user"),pass=$("#playerday").val()+"-"+$("#playermonth").val()+"-"+$("#playeryear").val();$.ajax({url:"/dashboard",type:"POST",data:{user:user,pass:pass},success:function(result){if("player"===result.type){var protocol=""!=window.location.protocol?window.location.protocol+"//":"",host=""!=window.location.host?window.location.host+"/":"";window.location.href=protocol+host+result.redirect}else $("#playerpop").find(".popUp").addClass("invalid-password"===result.type?"incorrect":"incorrect")}})}))},WELLNESS.CLIENT.Main.prototype.addFormEvents=function(){$("#backtodash").on("click",function(){var protocol=""!=window.location.protocol?window.location.protocol+"//":"",host=""!=window.location.host?window.location.host+"/":"";window.location.href=protocol+host+"dashboard"}),$(".serverAnsw .formBtnCont").on("click",function(){$(this).siblings().find(".formBtn").removeClass("selected"),$(this).find(".formBtn").addClass("selected"),$(this).parents(".serverAnsw").attr("data-answer",$(this).find("p").html())}),$(".popupAnsw .formBtnCont").on("click",function(){$(this).siblings().find(".formBtn").removeClass("selected"),$(this).find(".formBtn").addClass("selected"),$(this).parents(".popupAnsw").attr("data-answer",$(this).find("p").html())}),$(".tappop").on("click",function(){$(".popOverlay[popup-data-to="+$(this).attr("popup-data-from")+"]").show(),$(this).parents(".serverAnsw").attr("data-ispop",!0)}),$(".nopop").on("click",function(){$(this).parents(".serverAnsw").attr("data-ispop",!1)}),$(".popOverlay").on("click",function(e){var $box=$(".popUp"),$box_close=$(".closePop");(!$box.is(e.target)&&0===$box.has(e.target).length||$box_close.is(e.target))&&$(this).hide()}),$(".closePop").on("click",function(e){e.preventDefault(),$(".popOverlay").hide()}),$("#enotcomplete").find(".popUpBtn").on("click",function(){$("#enotcomplete").hide()}),$("#submitanswers").click(function(){var answers=[],form_completo=!0;$(".serverAnsw").each(function(){switch($(this).attr("data-type")){case"txt":$(this).find("input").val()?answers.push({id:$(this).attr("data-id"),txt:$(this).find("input").val()}):form_completo=!1;break;case"tap":$(this).attr("data-answer")?answers.push({id:$(this).attr("data-id"),txt:$(this).attr("data-answer")}):form_completo=!1;break;case"tappop":if($(this).attr("data-answer")){var specific={};$(this).attr("data-ispop")&&$(".popOverlay[popup-data-to="+$(this).attr("data-id")+"]").find(".popupAnsw").each(function(){specific[$(this).attr("data-header")]=$(this).attr("data-answer")}),answers.push({id:$(this).attr("data-id"),txt:{general:$(this).attr("data-answer"),specific:specific}})}else form_completo=!1}}),form_completo?$.ajax({url:"/playerform",type:"POST",data:{answers:answers},success:function(response){if("ok"==response.result){var protocol=""!=window.location.protocol?window.location.protocol+"//":"",host=""!=window.location.host?window.location.host+"/":"";window.location.href=protocol+host+response.redirect}else console.log("error")}}):$("#enotcomplete").show()})},WELLNESS.CLIENT.Main.prototype.addEditEvents=function(){var that=this;this.q_last=0;for(var question_id in this.data){var q_num=parseInt(question_id.slice(2),10);q_num>this.q_last&&(this.q_last=q_num)}$("#backtodash").on("click",function(){var protocol=""!=window.location.protocol?window.location.protocol+"//":"",host=""!=window.location.host?window.location.host+"/":"";window.location.href=protocol+host+"dashboard"}),$(".removeFormInstruct.minus").on("click",function(){var id=$(this).parents(".formQuestion").attr("data-id");that.data[id]&&(that.data[id].on=!1),$(this).parents(".col-xs-12.col-sm-12.col-md-12.col-lg-12").remove()}),$(".removeFormInstruct.plus").on("click",function(){$("#questiontype").show()}),$(".popOverlay").on("click",function(e){var $box=$(".popUp");$box.is(e.target)||0!==$box.has(e.target).length||$(this).hide()}),$(".crossWhite").on("click",function(){$(this).parents(".formBtnCont").remove()}),$(".pickquestions .removeFormInstruct.addAnswer").on("click",function(){new_button='	<a class="formBtnCont">',new_button+='		<div class="crossWhite"></div>',new_button+='		<input class="options_topick" name="Answer" value="Option" type="text"/>',new_button+="	</a>",$(this).parents(".formBtnCont").before(new_button),$(this).parents(".formBtnCont").prev().find(".crossWhite").on("click",function(){$(this).parents(".formBtnCont").remove()}),7==$(this).parents(".pickquestions").children().length&&$(this).parents(".formBtnCont").remove()}),$("#addTextQuestions").on("click",function(){$("#questiontype").hide(),that.q_last=that.q_last+1;var new_question="";new_question+='<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">',new_question+='<div class="formQuestion pickquestions" data-id="q_'+that.q_last+'" data-type="txt">',new_question+='	<div class="formInstruct input">',new_question+='		<div class="removeFormInstruct minus">',new_question+='			<div class="minusBlue"></div>',new_question+="		</div>",new_question+='		<input class="question_topick" name="Answer" value="Insert Question" type="text"/>',new_question+="	</div>",new_question+="	<form>",new_question+='		<input type="text"/>',new_question+="	</form>",new_question+="</div>",new_question+="</div>",$("#plusbutton").before(new_question),$('.pickquestions[data-id="q_'+that.q_last+'"]').find(".removeFormInstruct.minus").on("click",function(){var id=$(this).parents(".formQuestion").attr("data-id");that.data[id]&&(that.data[id].on=!1),$(this).parents(".col-xs-12.col-sm-12.col-md-12.col-lg-12").remove()})}),$("#addMPQuestions").on("click",function(){$("#questiontype").hide(),that.q_last=that.q_last+1;var new_question="";new_question+='<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">',new_question+='<div class="formQuestion pickquestions" data-id="q_'+that.q_last+'" data-type="tap">',new_question+='	<div class="formInstruct">',new_question+='		<div class="removeFormInstruct minus">',new_question+='			<div class="minusBlue"></div>',new_question+="		</div>",new_question+='		<input class="question_topick" name="Answer" value="Insert Question" type="text"/>',new_question+="	</div>",new_question+='	<a class="formBtnCont">',new_question+='		<div class="crossWhite"></div>',new_question+='		<input class="options_topick" name="Answer" value="Yes" type="text"/>',new_question+="	</a>",new_question+='	<a class="formBtnCont">',new_question+='		<div class="crossWhite"></div>',new_question+='		<input class="options_topick" name="Answer" value="No" type="text"/>',new_question+="	</a>",new_question+='	<div class="formBtnCont">',new_question+='		<div class="formBtn addAnswer">',new_question+='			<div class="removeFormInstruct addAnswer">',new_question+='				<div class="plusBlue"></div>',new_question+="			</div>",new_question+="		</div>",new_question+="	</div>",new_question+="</div>",new_question+="</div>",$("#plusbutton").before(new_question),$('.pickquestions[data-id="q_'+that.q_last+'"]').find(".removeFormInstruct.minus").on("click",function(){var id=$(this).parents(".formQuestion").attr("data-id");that.data[id]&&(that.data[id].on=!1),$(this).parents(".col-xs-12.col-sm-12.col-md-12.col-lg-12").remove()}),$('.pickquestions[data-id="q_'+that.q_last+'"]').find(".removeFormInstruct.addAnswer").on("click",function(){new_button='	<a class="formBtnCont">',new_button+='		<div class="crossWhite"></div>',new_button+='		<input class="options_topick" name="Answer" value="Option" type="text"/>',new_button+="	</a>",$(this).parents(".formBtnCont").before(new_button),7==$(this).parents(".pickquestions").children().length&&$(this).parents(".formBtnCont").remove()}),$('.pickquestions[data-id="q_'+that.q_last+'"]').find(".crossWhite").on("click",function(){$(this).parents(".formBtnCont").remove()})}),$("#savequestions").on("click",function(){$(".pickquestions").each(function(){var q_id=$(this).attr("data-id");if(that.data[q_id])switch($(this).attr("data-type")){case"txt":that.data[q_id].txt=$(this).find(".question_topick").val();break;case"tap":that.data[q_id].txt=$(this).find(".question_topick").val();var new_answers=[];$(this).find(".options_topick").each(function(){new_answers.push($(this).val())}),that.data[q_id].answers=new_answers}else switch($(this).attr("data-type")){case"txt":that.data[q_id]={txt:$(this).find(".question_topick").val(),type:"txt",on:"true"};break;case"tap":var brand_new_answers=[];$(this).find(".options_topick").each(function(){brand_new_answers.push($(this).val())}),that.data[q_id]={txt:$(this).find(".question_topick").val(),type:"tap",answers:brand_new_answers,on:"true"}}}),$.ajax({url:"/editquestions",type:"POST",dataType:"json",data:{questions:that.data},success:function(response){if("ok"==response.result){var protocol=""!=window.location.protocol?window.location.protocol+"//":"",host=""!=window.location.host?window.location.host+"/":"";window.location.href=protocol+host+response.redirect}else console.log("error")}})})},WELLNESS.CLIENT.Main.prototype.addReportEvents=function(){$("#backtodash").on("click",function(){var protocol=""!=window.location.protocol?window.location.protocol+"//":"",host=""!=window.location.host?window.location.host+"/":"";window.location.href=protocol+host+"dashboard"}),$("#sendreport").on("click",function(){$.ajax({url:"/excel",type:"POST",success:function(){}})}),setInterval(function(){$.ajax({url:"/generalreport",type:"GET",data:{refresh:!0},success:function(answers_by_date){var table="<thead>";table+="<tr>",table+="<th>",table+="</th>";for(var c=0;c<answers_by_date.questions.length;c++)table+="<th>"+answers_by_date.questions[c],table+="</th>";table+="</tr>",table+="</thead>",table+="<tbody>";for(var key in answers_by_date){var answer=answers_by_date[key];if("questions"!=key){table+="<tr>",table+='<td class="name"><div class="playerInfo">',table+='<span class="playerNo">'+key.substr(0,key.indexOf("-")-1)+"</span>",table+="<span>"+key.substr(key.indexOf("-")+1)+"</span>",table+="</div></td>";for(var d=0;d<answer.length;d++)table+="<td>"+answer[d],table+="</td>";table+="</tr>"}}table+="</tbody>",$("table").empty().append(table)}})},15e3)};